"""Tests the kmeans."""

import math

import kmeans
from pytest import approx


def test_euclidean_distance():
    p1 = (3, 2)
    p2 = (4, 1)

    retrieved = kmeans.euclidean_distance(p1, p2)
    assert retrieved == approx(math.sqrt(2))


def test_centroid():
    p = (3, 12)
    c = kmeans.Centroid(index=1, center=p)

    c.set_center((3, 2))

    assert c.get_index() == 1

    retrieved = c.get_distance(kmeans.Point(4, 1))
    assert retrieved == approx(math.sqrt(2))


def test_kmeans():
    dataset = [
        (-6.73, 6.5), (-4.43, 7.24), (-4.17, 6.22), (-3.39, 7.73),
        (-2.93, 6.53), (5.25, -7.29), (6.76, -8.36), (6.95, -6.75),
        (7.06, -7.12), (7.4, -6.86)
    ]
    k = kmeans.KMeans()
    k.fit(2, dataset, seed=45)

    print(k.get_centroids())
    print(k.get_repetitions())


def test_kmeans_2():
    dataset = [[-6.43025361936906, -6.080161479241888],
               [1.251390955759029, 10.685873005018104],
               [-6.386278246641961, -16.440386167375948],
               [4.638244915902865, -12.06465802158252],
               [-4.104330478278422, -6.488391533573458],
               [6.218435506175436, -1.161176783747007],
               [-8.712516897265997, 0.811632979522261],
               [-7.701032379307605, 1.2819899008343993],
               [-4.801996096473397, -2.6163489029543125],
               [-4.567945428673495, 1.444177395511539],
               [1.1726868300512345, -2.3440450183002133],
               [-13.796365071540585, 0.5953204797417602],
               [4.660087021842509, -15.346679475117664],
               [-1.5659942592838192, -2.710896056885093],
               [-4.268852458657072, -9.24547639795723],
               [-8.318927012124144, -8.881541182680364],
               [11.96979276997918, -8.552882842626884],
               [-11.182377493341479, -13.803442808360792],
               [20.725899511594015, -13.0688982416508],
               [-2.2298138274633317, 6.225085480066385],
               [-9.813729002390883, -6.778171169070129],
               [-2.0491160510055133, -4.284746901438533],
               [-1.0147265314774643, -9.72995382843883],
               [10.446800820883496, -8.604201507822346],
               [2.7458123500422706, 0.6660626232299722],
               [7.216496010362573, -13.22308556403539],
               [-7.217052571981501, 9.946007104482108],
               [13.409262507104096, 11.851027423893845],
               [-14.66167047697964, -0.7582045838562737],
               [7.527936085810597, -8.649754876566192],
               [1.65522220194921, -0.0690772565746216],
               [-13.887719458930572, -13.357214373726741],
               [10.553201137190715, -3.8194566203003126],
               [8.529317172851794, 3.0999900290988545],
               [-13.991795802109475, -13.063971097761216],
               [-4.372049122914429, 2.9608818041700165],
               [-2.9996141105306995, -24.390329285857767],
               [-0.1406127079212678, -5.245340496309271],
               [7.913723801178898, -1.483591728016588],
               [-5.900749502691422, -14.10186705865629],
               [2.5504615185347066, -5.674150704526481],
               [5.644496392424331, -10.204985567054331],
               [4.424533729574426, 0.051447101881201274],
               [-9.842087618964273, 0.2848019586617925],
               [-10.428833013516208, -4.807625550056404],
               [-8.845073176914093, -4.309092332202614],
               [6.55466636278249, -8.355417315561557],
               [3.136598520957037, -4.706269898979005],
               [15.497353517999219, -12.332909294101814],
               [-3.1038945735191685, -0.24604640890448337],
               [-4.89743202268386, -1.1695770322168628],
               [-7.29877537344949, -3.469911673076025],
               [-11.459440114438156, -0.12074635055547422],
               [-0.5964357998165015, -11.461160365591658],
               [-7.814087801995245, 1.5118016473531535],
               [-14.108428966708326, -4.688491143567208],
               [-8.290436525501297, 9.992390920203036],
               [-3.45418503294314, -4.879221526317927],
               [2.4014628774424454, 13.488694770931401],
               [15.004593219089735, -4.944505084363929],
               [3.020230377420097, 4.969271055630183],
               [-16.798839925696942, -6.620550681335078],
               [-14.478531460485137, -13.8658157519939],
               [13.15470847913286, -13.320993865094428],
               [-12.741575760063133, -13.987564686300974],
               [1.9416922989032281, 1.2471197907308316],
               [-4.245535608311543, 5.2848223775169965],
               [9.339231660123373, -9.380946122240328],
               [-10.444261155630825, -7.334689007200287],
               [-4.629016880925404, -4.801554030380503],
               [5.884278184788712, -1.9489414490792507],
               [8.668895829609628, 0.9228073665127716],
               [0.42957535470245567, 0.2925915549642979],
               [3.775065537436517, -9.00054536604418],
               [3.480405039899636, 6.435411144805485],
               [5.352876712654746, -7.9658796056073715],
               [-13.438675295819962, -4.188368569621884],
               [-2.8955711707203298, -7.651244220745828],
               [1.407200246553658, -5.014606752390408],
               [0.939447866210517, -10.999443911865841],
               [-9.8613789909206, -0.6270133393730593],
               [4.81900102073533, -17.77691498466804],
               [-9.986229713750395, -2.765999401233493],
               [8.648208159670197, 10.459403757446768],
               [-3.68313031036095, 2.5354095844654347],
               [6.091285056408137, 0.8439709468773966],
               [10.560128045522623, 2.543574565022432],
               [-1.8769631510981055, 13.391616412514974],
               [-22.196503942302723, -2.7652388559886716],
               [2.5422613563119896, 1.4167941884131192],
               [-13.46577132722524, -8.535353306180863],
               [3.92913624000907, -6.514736611092471],
               [-2.1016908026166847, -9.83415248872245],
               [-5.653041090878405, -0.02273158542348863],
               [0.5473554009932662, 8.804494291674102],
               [-5.831005193882278, -1.9444164953837024],
               [0.6774803148435842, -8.641079097941937],
               [2.572625701650831, -3.235038299043266],
               [-4.05512534965415, -6.162463299725058],
               [9.41639629884904, -14.152419177616704],
               [0.43013727160404114, -3.7500767153834658],
               [11.26916301772648, -2.928493194919433],
               [6.970413373840455, -9.128217733050207],
               [-4.292005164567329, -1.1109784758861343],
               [-20.11545893111553, -8.024351404007543],
               [0.24562721746729999, 2.820634583992863],
               [4.399450556277115, -11.23689225415176],
               [9.655522478107024, -6.640302429966544],
               [-3.6084724543401343, 2.503050233622342],
               [-5.202123453836107, 1.3253210909455087],
               [-3.256114469755633, -3.313712453033248],
               [3.2055661386624132, 2.9894947543869907],
               [-5.465534100160321, -5.737371586338526],
               [-6.8656547168935935, 3.633839672564471],
               [-8.188864766140476, 0.8761294424679136],
               [-8.7988847925714, -2.448795742575088],
               [-8.809833443291879, -9.79712671621759],
               [-3.125130892641495, -12.228034349867638],
               [7.5859119307215614, -15.804855363965071],
               [-18.41510448416966, -10.893077085305967],
               [4.417625292725289, -3.4412748620113973],
               [-0.5610376251957727, -4.124432580885962],
               [-3.5095258935671048, 3.074410760369319],
               [-13.561849830345567, -7.463049706212778],
               [-4.353011822068307, -6.702734146610763],
               [9.62862764397334, -18.5500403179582],
               [12.941672396882755, 10.006397233966265],
               [-1.1390239273882505, -8.266613731500197],
               [-16.681979616097653, -12.487089026303906],
               [15.439090691708307, -18.469761486276347],
               [13.660559066692063, -7.051894341659039],
               [-4.25505744363868, -9.635592203581304],
               [7.891249263986605, -1.7116965295613955],
               [1.544006177888142, -2.7296100396122602],
               [1.4437148837614489, -4.493720847529563],
               [-10.924095289634586, -4.798393425224267],
               [-7.984031573181994, 3.4885730992387103],
               [4.556995456058729, 6.470041818896209],
               [-0.335019516800088, -1.215972262123536],
               [-13.470333346728012, -2.4284369325580286],
               [1.5454835411953325, 6.512370791057435],
               [3.9786568541893796, -3.491114962500613],
               [8.990654382563498, -2.555207829168989],
               [1.2107866027907936, -0.9889345809843952],
               [-6.987530004096033, 1.1165841835914074],
               [2.4199546901125277, -8.046312852275165],
               [13.370167775157775, -9.513084408858575],
               [-12.443688171250827, 1.0576652444356052],
               [-1.8421509848172382, 3.010519854222313],
               [-1.6380060255410234, 4.6184706407194485],
               [11.074899825546405, -13.062919674200018],
               [-2.594648480767589, -5.1180995694360885],
               [7.6972005222883295, 9.198212062715776],
               [-3.3943578354710704, -1.033460449904835],
               [5.100319621068854, -12.486796755818888],
               [-0.6913023541970298, -13.06804432276946],
               [8.626535080472648, -5.996388249112775],
               [-0.7963804981363847, -12.398012689671067],
               [4.052843498431759, 5.144265149642862],
               [-6.791084587963269, -13.16965232372911],
               [1.1992787893671242, -4.082262599339629],
               [2.2908734304454526, 8.08680021151509],
               [-2.923516415774725, 8.191102217002335],
               [-9.495310865562029, -11.688433472934728],
               [4.208471539795931, -4.996777137507788],
               [12.239896565112108, -2.7853591347216504],
               [-1.1147505324048192, -5.502255073954306],
               [-7.964094424650791, -9.294325315140396],
               [-11.424172289541147, -0.053170367276603514],
               [-4.940743071546953, -4.59563199647441],
               [-1.9130070847987382, 4.23859899754],
               [3.1350531134578246, -1.684030273428034],
               [9.086491488229356, -6.937599965019667],
               [19.67308057757635, 0.5054056049152229],
               [5.110368819781536, -2.060070877807931],
               [5.931959312521606, -1.8947904698527491],
               [-2.2546506012315923, -2.888637553664781],
               [-1.4785751937488243, -11.61205576190385],
               [-5.358499258345156, -9.183391809795246],
               [-13.724711164113778, 2.6218561925386323],
               [-11.93869929418215, -6.0827901287790915],
               [10.305202529588065, 4.471430458045581],
               [-10.300938005382863, -10.041183096120028],
               [-0.35881218800978054, 0.31002104902221417],
               [-1.8418023494028288, -2.0610310669175504],
               [-4.665740419351751, -9.505145223708379],
               [-11.861513720160445, 3.644382559502775],
               [4.657220555172513, -7.195808213439466],
               [2.1999359118603796, 8.660854708570513],
               [-12.410749297886468, -3.1908375016940136],
               [-2.8408407794015336, -3.846016027071789],
               [-10.258558026816207, -8.134088521229517],
               [-14.379381543832448, -1.3816433241648012],
               [-10.730067473385988, 0.05313998336437109],
               [6.035762892803718, -4.070753738367839],
               [13.436309598295836, -15.753550985634565],
               [-11.73295990294858, -3.0984899540578112],
               [-3.4441225347177062, 6.298774115089925],
               [-7.339757053104538, 8.085736617137705],
               [15.946181887040535, -17.171304143020834],
               [-0.10351651918296056, -9.084956756335536],
               [5.393064225570766, 4.9376227299229125],
               [-6.442273470330579, -4.6578372434278315],
               [-11.509484805686196, -11.772678156493438],
               [7.293992689954663, -4.3302337159988635],
               [13.460388062031996, -11.165067248239078],
               [1.4850956669592366, -3.287709755478847],
               [-1.4231056699049582, -14.872057052414569],
               [5.375017799467142, 3.515459901070566],
               [1.0801960389186407, -7.120474091052985],
               [4.2033505850402015, 10.113922970303001],
               [-4.420969186312475, -7.2707135917735215],
               [-7.971579315583511, -12.709936601511],
               [-7.663183890195903, -11.24749260257202],
               [10.867873336531002, -11.897384014686356],
               [4.393797744366157, -4.955409458636046],
               [-8.171756198960423, -8.376060716613383],
               [-1.8106302103188319, 2.2424907623661476],
               [-5.390879948654009, -1.9077905473275636],
               [2.6504531397889943, -6.4752545332762885],
               [-0.5762246108364222, 2.231962512550804],
               [-15.697734278300084, -4.75990671170047],
               [-1.514602238091709, 6.546016696560372],
               [1.0661971720100123, 1.720672939691977],
               [-2.7753714746350946, 4.74053189053793],
               [-4.972786968438781, -4.896948463101071],
               [-9.552023997655393, -2.527537715945704],
               [-7.182035340264987, -11.727413592763941],
               [1.1423195422144685, -2.133231474203443],
               [-4.441224878573721, -5.01199713594766],
               [12.270184866149599, 0.9636665492922933],
               [-7.901361473930819, -4.672892711736031],
               [2.06363626345757, -0.6228343485061147],
               [0.0896475690205134, -3.043749274992748],
               [-6.539347993364496, 12.810008578952878],
               [17.259176182589112, -16.521747226238627],
               [1.9890923378611483, -11.504431136622475],
               [-3.2008515324945828, -5.939030572685778],
               [-10.550618811855696, -10.096485344401136],
               [-9.488865521846654, -10.034520754840404],
               [3.625502031528971, -13.446133153162606],
               [-1.455836141677068, -1.398322766113849],
               [-11.7493900569663, 0.3182540508926204],
               [-8.209361890359936, 0.4046459139178924],
               [-14.376399259297585, -15.737127646320435],
               [10.344543319472018, -13.360095803042746],
               [-2.9800733231177414, -11.722557083601611],
               [3.29620954477865, -3.842148674810143],
               [-3.7668671305384978, 1.2775647423675025],
               [-8.526556412242755, -1.061723600710653],
               [3.961757556081797, -5.157171995728845],
               [-16.024450203849845, -10.989689933003328],
               [2.912152714293448, -1.7804495407355434],
               [1.417227313210561, -13.08430462498362],
               [14.16560267658063, -7.123349244525949],
               [-0.04011032048925811, 0.9140953919690427],
               [4.3106630634607495, 5.537827348023924],
               [-12.942122164582683, -4.227186435185933],
               [1.9571544757170036, -5.9388696420557245],
               [-4.115811575143529, -4.8684798545812455],
               [-7.576367106495775, -1.8527383020738974],
               [8.961350836211897, -18.59090531234673],
               [6.916587643012049, 0.47120267954087547],
               [-7.26293642620706, -4.707526113795019],
               [4.28223074937676, -5.263863649566664],
               [3.5889378376264576, -4.743985946249426],
               [-4.541368575403123, -16.07269518281991],
               [-9.404791099596647, -5.658220144015968],
               [-8.348719124950001, 3.511764733725654],
               [-2.2908564855124434, 1.3443610182737098],
               [-6.12100145990349, -7.812255900617606],
               [2.6642394606114532, -15.300317826875657],
               [0.5646943336970143, 2.060250832199367],
               [5.409813524034756, -6.222512820781181],
               [6.217787742971158, -11.386924829801544],
               [-10.087253843196281, 2.4402892647464993],
               [3.8428626680856746, 2.8218705083956714],
               [4.819677431713437, -14.929686601010129],
               [-0.11108790453536876, 1.2473887530128052],
               [5.447255006251182, -10.034217287444465],
               [3.712444104932974, -3.725280057272299],
               [12.568214717276152, -15.466794746189963],
               [-9.882123100971647, -2.261367029749465],
               [2.817464767280323, -8.155344444498553],
               [1.1763966494637417, 8.569596883731542],
               [4.261443851194336, 4.105404584080847],
               [8.65811889468031, 5.023880371206553],
               [7.592063829840825, 0.35020336750871994],
               [-1.60363704038076, -4.0822915728075495],
               [-18.727197220600047, -4.195132370620936],
               [-10.09772649480281, 2.8967855439193855],
               [0.6939975929515505, -2.3775178303628355],
               [-0.3588172578901325, -5.9544413397049265],
               [-5.21331278602405, -8.056942747372856],
               [5.266435802371083, -18.543754887175115],
               [0.28154054936916384, -4.699088919141995],
               [1.2423507484614387, -11.923733108210572],
               [-2.01684081921381, -0.6011058652597476],
               [13.06898012879606, -9.854925544059462],
               [-6.327864458387312, -1.968380096472936],
               [1.905204848653284, -10.966476068381546],
               [-7.1825246322931156, -4.306834064927963],
               [-15.641536855772571, -8.552965896749992],
               [-5.207652299722321, 0.46182729482841767],
               [3.2033119778224606, 2.8860087336652906],
               [1.2156405778713175, -6.953328609558994],
               [-12.12455462427926, -4.185388961933377],
               [14.700039979968729, -3.4734815673218833],
               [1.5445288122341112, -3.8030307195759265],
               [-6.008690560647579, -5.444541143854735],
               [4.38134717641646, -0.8074874479505303],
               [0.5333763758897052, -0.9260827430080676],
               [-2.15697558426588, -2.2964263811133065],
               [-5.8964918796314665, -7.505783085744181],
               [-9.41726080758459, -17.450381962275532],
               [14.831231022929252, -13.899712033752403],
               [-2.651129232304552, -4.447589795673748],
               [-2.2977679108402578, -4.2208065260955605],
               [12.267497258598004, -10.963672741466354],
               [13.18564688886696, 2.6017678451385926],
               [5.994304249489725, -8.354047094725091],
               [-0.6661122532383019, 8.061752106737394],
               [-4.097590173516517, -16.998740698794073],
               [6.676670647220286, -4.079747228541104],
               [-4.582217184119349, -6.292647883804762],
               [4.812315523194122, -0.24396453553630248],
               [6.983042580454405, 5.053000637258844],
               [-0.6949769447082859, 1.1566268929023904],
               [-2.905501686569453, -5.759941811181699],
               [15.048719525163659, -9.406698278183223],
               [-2.7682534475640894, -3.5385127481762133],
               [-10.13446525435345, 5.663063941031996],
               [3.798477301686471, -19.45948741483798],
               [-14.969875173590015, 0.6373948950780757],
               [9.933219656372763, -3.892079910772016],
               [-4.949492179876671, 2.088479780073034],
               [-5.730939196247013, -6.195117920252835],
               [-2.228922433399365, -4.149435443791403],
               [-7.499840259818643, -4.389372424767673],
               [2.241051165797114, 0.0263132410355289],
               [-7.093606729169836, -4.070351826075023],
               [-3.9675729986097883, -6.290785063717626],
               [-1.6149074700648693, -2.801565860425043],
               [-3.363677667589672, -10.194413366325001],
               [11.209671782803857, -7.482388686249173],
               [-1.8811632282021806, 6.964847239543232],
               [-4.5582977717888244, -10.342552943121358],
               [-7.083988628550794, -10.805204698328406],
               [-7.303450210392555, -10.950996227962053],
               [1.557227094570778, 0.37390868676631683],
               [2.6184140238273805, -4.029991882852052],
               [2.5709713385174533, -7.77304624885807],
               [5.877470877160549, -7.36136450464969],
               [11.625637358946154, -10.198892876481423],
               [-0.5797387359928743, -7.586123059510465],
               [4.133710812272555, -9.436060210489254],
               [-6.433677147133551, 5.273960848130876],
               [-5.288725064682573, -3.1056354219687377],
               [9.297208911669834, -13.019929405128085],
               [-13.660785731237485, -7.337223784992576],
               [-13.36266042726904, -8.755548381922317],
               [14.768503536351353, 0.5091843426582532],
               [8.146921176260376, -6.112410651995143],
               [-3.874822594958763, -5.111393004496951],
               [0.7303728134469001, -12.851663939728805],
               [1.508946612032533, -4.050787169452385],
               [-12.42947408287411, -8.073440597083422],
               [-7.953215658089606, -5.017840745392367],
               [-6.718716723083321, 1.8618622171174328],
               [-5.33992286062589, -10.154429252570798],
               [-6.153566122301197, -4.269779141963689],
               [-8.90261791134612, 2.2275655552968967],
               [-10.678077820541134, 0.1982856970027611],
               [-7.150518897003852, -6.669080307188041],
               [21.809192529694755, -2.619623368415371],
               [15.325388098262849, -9.362854712553082],
               [1.0138043022630567, -4.310997722985695],
               [-3.001697229505681, -5.170699688305308],
               [7.012944790431384, -8.220189442870097],
               [1.3300383383204417, -7.713482137989783],
               [4.383523997876666, -16.233417054934392],
               [0.19216576269126584, 11.089754216159397],
               [-5.945793084637518, -11.275425596321414],
               [5.566937297738623, 5.067902394717313],
               [14.772677641165753, -1.2788492110083176],
               [4.632498615236784, -7.947451208402741],
               [-18.953176056322718, -7.906838606207955],
               [-3.2392007036262087, -8.716230716664484],
               [-0.04336211414401481, 2.4489497687414774],
               [-1.9494652531658172, -7.498215795710543],
               [13.452365910275976, -2.272460897195497],
               [2.5551741924616125, 6.829629285447788],
               [-2.892870176985059, -0.13318467644441068],
               [9.620883623768785, -11.950901369985328],
               [-2.255865952084571, 1.0023366889829635],
               [-3.6825997709660037, 1.646011248458045],
               [15.301749318134128, -6.697068744197428],
               [-0.562894264380505, -6.795500758962023],
               [-6.428123691330579, -8.549941372339802],
               [-6.906518356443492, -5.177098999471828]]

    k = kmeans.KMeans()
    k.fit(2, dataset, seed=45)

    print(k.get_centroids())
    print(k.get_repetitions())

